nextflow_process {

  name "Test process xy"

  script "test-data/test_process.nf"
  process "TEST_PROCESS"

  profile "docker"

  test("Should create 5 files") {

    debug true

    when {
      """
      input[0] = Channel.of(1..5)
      input[1] = "test"
      params.outdir = "seb7"
      """
    }

    then {
      assert process.success
      assert output.my_output_files
      assert output.my_output_files.size() == 5
      def file1 = new File(output.my_output_files.get(0))
      //assert file1.name == "1_test.txt" //TODO: needs a sorted list. sort in nf-testflight
      assert file1.name.endsWith("_test.txt")
      assert file1.text == 'lukas forer\n'

      assert output.my_output_tuple
      assert output.my_output_tuple.size() == 5
      assert output.my_output_tuple.get(0).size() == 3
    }

  }
}
